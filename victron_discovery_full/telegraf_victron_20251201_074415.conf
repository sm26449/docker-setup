# Telegraf Configuration - Victron Energy
# Auto-generated by victron_mqtt_explorer.py
# Generated: 2025-12-01T07:44:15.893315
# Portal ID: c0619ab7d12b

[[inputs.mqtt_consumer]]
  servers = ["ssl://192.168.88.250:8883"]

  client_id = "telegraf-victron"
  qos = 0
  connection_timeout = "30s"

  username = "admin"
  password = "rbdc9vtrc8"

  insecure_skip_verify = true

  topics = [
    "N/c0619ab7d12b/adc/#",
    "N/c0619ab7d12b/battery/#",
    "N/c0619ab7d12b/ble/#",
    "N/c0619ab7d12b/digitalinputs/#",
    "N/c0619ab7d12b/fronius/#",
    "N/c0619ab7d12b/grid/#",
    "N/c0619ab7d12b/hub4/#",
    "N/c0619ab7d12b/logger/#",
    "N/c0619ab7d12b/modbusclient/#",
    "N/c0619ab7d12b/modbustcp/#",
    "N/c0619ab7d12b/platform/#",
    "N/c0619ab7d12b/pvinverter/#",
    "N/c0619ab7d12b/settings/#",
    "N/c0619ab7d12b/system/#",
    "N/c0619ab7d12b/temperature/#",
    "N/c0619ab7d12b/vebus/#",
    "N/c0619ab7d12b/vecan/#",
  ]

  data_format = "json_v2"

  [[inputs.mqtt_consumer.json_v2]]
    [[inputs.mqtt_consumer.json_v2.field]]
      path = "value"
      rename = "value"

  # Topic parsing - extracts device_type as measurement
  [[inputs.mqtt_consumer.topic_parsing]]
    topic = "N/+/+/+/+"
    measurement = "_/_/measurement/_/_"
    tags = "_/portal_id/_/instance/field"

  [[inputs.mqtt_consumer.topic_parsing]]
    topic = "N/+/+/+/+/+"
    measurement = "_/_/measurement/_/_/_"
    tags = "_/portal_id/_/instance/field/subfield"

  [[inputs.mqtt_consumer.topic_parsing]]
    topic = "N/+/+/+/+/+/+"
    measurement = "_/_/measurement/_/_/_/_"
    tags = "_/portal_id/_/instance/field/subfield/subfield2"
